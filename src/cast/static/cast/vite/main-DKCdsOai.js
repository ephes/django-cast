var M=Object.defineProperty;var E=(i,a,t)=>a in i?M(i,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[a]=t;var l=(i,a,t)=>E(i,typeof a!="symbol"?a+"":a,t);class m extends HTMLElement{constructor(){super();l(this,"currentImage");l(this,"currentModal");l(this,"boundThumbnailClick");l(this,"boundFooterClick");l(this,"boundKeydown");this.currentImage=null,this.currentModal=null,this.boundThumbnailClick=this.handleThumbnailClick.bind(this),this.boundFooterClick=this.handleFooterClick.bind(this),this.boundKeydown=this.handleKeydown.bind(this)}static register(t){console.log("Registering image-gallery-bs4!"),"customElements"in window&&customElements.define(t||"image-gallery-bs4",m)}replaceImage(t){if(this.currentImage){const e=this.currentImage.getAttribute(t);if(e==="false")return;const r=this.querySelector("#"+e);r&&this.setModalImage(r)}}resolveModal(t){if(t){const e=t.getAttribute("data-target");if(e){const r=document.querySelector(e);if(r)return r}}return this.querySelector(".modal")}bindModalEvents(t){const e=t.querySelector(".modal-footer");e&&!e.hasAttribute("data-gallery-footer-bound")&&(e.addEventListener("click",this.boundFooterClick),e.setAttribute("data-gallery-footer-bound","true")),t.hasAttribute("data-gallery-keydown-bound")||(t.addEventListener("keydown",this.boundKeydown),t.setAttribute("data-gallery-keydown-bound","true"))}unbindModalEvents(t){const e=t.querySelector(".modal-footer");e&&e.hasAttribute("data-gallery-footer-bound")&&(e.removeEventListener("click",this.boundFooterClick),e.removeAttribute("data-gallery-footer-bound")),t.hasAttribute("data-gallery-keydown-bound")&&(t.removeEventListener("keydown",this.boundKeydown),t.removeAttribute("data-gallery-keydown-bound"))}ensureModalInBody(t){t.parentElement!==document.body&&document.body.appendChild(t),this.id&&!t.hasAttribute("data-gallery-owner")&&t.setAttribute("data-gallery-owner",this.id),this.bindModalEvents(t)}cleanupModal(){const t=this.id,e=t?`.modal[data-gallery-owner="${t}"]`:null,r=e?document.querySelector(e):this.currentModal;r&&r.parentElement===document.body&&(this.unbindModalEvents(r),r.remove()),this.currentModal=null}setModalImage(t,e){var g,v,k;if(this.currentImage=t,!t.parentNode){console.error("No parent node for image: ",t);return}const r=t.parentNode;if(!r.parentNode){console.error("No parent node for thumbnail picture: ",r);return}const u=(g=r.parentNode.getAttribute("data-full"))!=null?g:"",p=r.querySelector("source");if(!p){console.error("No thumbnail source for picture: ",r);return}const s=(v=e!=null?e:this.currentModal)!=null?v:this.resolveModal();if(!s){console.error("No modal for image gallery: ",this);return}this.ensureModalInBody(s),this.currentModal=s;const n=s.querySelector(".modal-body");if(!n){console.error("No modal body for modal: ",this);return}console.log("modalBody: ",n);const y=s.querySelector(".modal-footer");if(!y){console.error("No modal footer for modal: ",this);return}const A=[{attr:"data-modal-srcset",prop:"srcset"},{attr:"data-modal-src",prop:"src"},{attr:"type",prop:"type"},{attr:"data-modal-sizes",prop:"sizes"}],f=n.querySelector("source");if(!f){console.error("No modal source for modal body: ",n);return}for(const{attr:b,prop:h}of A){const c=p.getAttribute(b);c&&f.setAttribute(h,c)}const w=[{attr:"alt",prop:"alt"},{attr:"data-prev",prop:"data-prev"},{attr:"data-next",prop:"data-next"},{attr:"data-fullsrc",prop:"src"},{attr:"data-modal-srcset",prop:"srcset"},{attr:"data-modal-sizes",prop:"sizes"},{attr:"data-modal-height",prop:"height"},{attr:"data-modal-width",prop:"width"}],d=n.querySelector("img");if(!d){console.error("No modal image for modal body: ",n);return}((k=d.parentNode)==null?void 0:k.parentNode).setAttribute("href",u);for(const{attr:b,prop:h}of w){const c=t.getAttribute(b);c&&d.setAttribute(h,c)}let o="";d.getAttribute("data-prev")!=="false"?o=o+'<button id="data-prev" type="button" class="btn btn-primary">Prev</button>':o=o+'<button id="data-prev" type="button" class="btn btn-primary disabled">Prev</button>',d.getAttribute("data-next")!=="false"?o=o+'<button id="data-next" type="button" class="btn btn-primary">Next</button>':o=o+'<button id="data-next" type="button" class="btn btn-primary disabled">Next</button>',y.innerHTML=o}handleThumbnailClick(t){t.preventDefault(),t.target;const e=t.currentTarget,r=e.querySelector("img");if(r){const u=this.resolveModal(e);this.setModalImage(r,u)}else console.error("No img element found in clicked thumbnail")}handleFooterClick(t){const e=t.target;e.matches("#data-prev, #data-next")&&this.replaceImage(e.id)}handleKeydown(t){t.key==="ArrowLeft"&&this.replaceImage("data-prev"),t.key==="ArrowRight"&&this.replaceImage("data-next")}connectedCallback(){this.querySelectorAll(".cast-gallery-container > a").forEach(e=>{e.classList.contains("event-added")||(e.addEventListener("click",this.boundThumbnailClick),e.classList.add("event-added"))})}disconnectedCallback(){this.querySelectorAll(".cast-gallery-container > a").forEach(e=>{e.removeEventListener("click",this.boundThumbnailClick),e.classList.remove("event-added")}),this.cleanupModal()}}m.register("image-gallery-bs4");
